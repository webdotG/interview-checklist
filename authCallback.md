## Архитектура механизма колбэка авторизации

```
graph TD
    A[Пользователь] -- "Нажимает Войти/Выйти" --> B(AuthUI.js)
    B -- "Вызывает метод" --> C[auth.service.js]
    C -- "Отправляет запрос" --> D(Firebase Auth)

    D -- "Возвращает статус" --> C
    C -- "Запускает колбэк" --> E(setOnAuthStateChangedCallback)

    E -- "Передаёт статус пользователя" --> B
    B -- "Вызывает метод" --> F(updateUI)
    F -- "Обновляет состояние кнопок и текста" --> G(HTML/CSS)

Описание компонентов и процесса

1. auth.service.js
    Отвечает за:
    Низкоуровневое взаимодействие с Firebase Authentication.
    Предоставляет методы для входа (signInWithGitHub), выхода (signOut) и,
    что самое важное, метод setOnAuthStateChangedCallback(callback).

    Этот метод "подписывает" другой компонент на события авторизации Firebase.
    Когда статус пользователя меняется, Firebase вызывает этот колбэк.

2. AuthUI.js
    Отвечает за:
    Управление UI. В его конструкторе вызывается authService.setOnAuthStateChangedCallback(), где в качестве колбэка передается его собственный метод this.updateUI().

    Это означает, что как только auth.service.js получает новый статус от Firebase (например, пользователь только что вошёл), он немедленно запускает AuthUI.js.updateUI().

3. Firebase Auth
    Это внешний сервис, который отслеживает сессию пользователя.
    Он автоматически уведомляет auth.service.js о любых изменениях, будь то вход, выход, обновление токена или истечение сессии.

4. Процесс работы колбэка

    Пользователь нажимает кнопку "Войти".

    AuthUI.js вызывает auth.service.js.signInWithGitHub().

    Firebase обрабатывает запрос и возвращает результат.

    auth.service.js получает ответ и автоматически вызывает колбэк, который был зарегистрирован ранее.

    Колбэк запускает AuthUI.js.updateUI(user), передавая ему объект пользователя.

    updateUI скрывает кнопку входа, показывает кнопку выхода и информацию о пользователе, приводя интерфейс в актуальное состояние.
```
